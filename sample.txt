The first working code plus a little modification